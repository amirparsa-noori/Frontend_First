
import React, { useState, useRef, useEffect } from 'react';
import Navbar from './components/Navbar';
import Hero from './components/Hero';
import ProductCard from './components/ProductCard';
import ProductDetailModal from './components/ProductDetailModal';
import Cart from './components/Cart';
import Footer from './components/Footer';
import Auth from './components/Auth';
import Profile from './components/Profile';
import AddressForm from './components/AddressForm';
import CheckoutWizard from './components/CheckoutWizard';
import Consultation from './components/Consultation';
import MobileNav from './components/MobileNav';
import Magazine from './components/Magazine';
import { Product, CartItem, User, Address, Review, BlogPost, Order, OrderStatus, ShippingMethod } from './types';
import { ArrowDown, Search, X as CloseIcon, SlidersHorizontal, Baby, Dumbbell, Pill, Sparkles, Feather, LayoutGrid, Bone, Filter, SortAsc, SortDesc, Zap, ChevronLeft, ArrowLeft, Stethoscope, RotateCcw } from 'lucide-react';

// --- EXPANDED DATA ---
const MOCK_PRODUCTS: Product[] = [
  // پوست و مو (Skin & Hair)
  {
    id: 1,
    name: "کرم ضد آفتاب تخصصی لافارر SPF50",
    description: "محافظت کامل در برابر اشعه‌های UVA و UVB، مناسب پوست‌های چرب و مختلط.",
    price: "۴۵۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1556228720-19de77d64eae?q=80&w=2000",
    category: "پوست و مو",
    brand: "Lafarrerr",
    details: {
      properties: [
        { label: "نوع محصول", value: "کرم ضد آفتاب" },
        { label: "حجم", value: "40 میلی لیتر" },
        { label: "نوع پوست", value: "چرب و مستعد آکنه" },
        { label: "SPF", value: "50+" },
        { label: "محفظه", value: "تیوپی" },
        { label: "کشور سازنده", value: "ایران" },
        { label: "شرکت سازنده", value: "لابراتوار دکتر کامکار" }
      ],
      features: [
        "فاقد چربی و جلوگیری از ایجاد جوش",
        "مات کننده پوست",
        "محافظت طیف گسترده (Broad Spectrum)",
        "ضد لک و روشن کننده",
        "حاوی عصاره شیرین بیان و بیربری"
      ],
      usage: "نیم ساعت قبل از قرار گرفتن در معرض آفتاب روی پوست تمیز استفاده شود و هر 2 تا 4 ساعت تمدید گردد.",
      warnings: "از تماس با چشم خودداری شود. در صورت بروز حساسیت مصرف را قطع کنید.",
      storage: "در دمای اتاق و دور از تابش مستقیم نور خورشید نگهداری شود."
    }
  },
  {
    id: 2,
    name: "سرم ویتامین سی پریم",
    description: "روشن کننده و جوان کننده پوست، حاوی ویتامین C پایدار.",
    price: "۱,۲۵۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1620916566398-39f1143ab7be?q=80&w=1887",
    category: "پوست و مو",
    brand: "Prime",
    details: {
      properties: [
        { label: "نوع محصول", value: "سرم صورت" },
        { label: "حجم", value: "30 میلی لیتر" },
        { label: "ماده موثره", value: "ویتامین C پایدار" },
        { label: "بافت", value: "سبک و زود جذب" },
        { label: "کشور سازنده", value: "ایران" },
        { label: "برند", value: "پریم (Prime)" }
      ],
      features: [
        "کاهش لک‌های پوستی و کک و مک",
        "تحریک کلاژن سازی و کاهش چروک‌های سطحی",
        "آنتی اکسیدان قوی",
        "افزایش درخشندگی و شفافیت پوست",
        "رطوبت رسانی عمیق"
      ],
      usage: "روزی یک یا دو بار روی پوست تمیز صورت و گردن ماساژ دهید تا جذب شود. استفاده از ضدآفتاب در طول روز الزامی است.",
      warnings: "روی پوست ملتهب یا زخم باز استفاده نشود. ممکن است در دفعات اول کمی احساس گزگز ایجاد کند.",
      storage: "در جای خنک و ترجیحاً در یخچال نگهداری شود تا از اکسید شدن ویتامین C جلوگیری شود."
    }
  },
  {
    id: 5,
    name: "شامپو ضد ریزش کافئین سریتا",
    description: "محرک رشد مو، افزایش خون‌رسانی به کف سر.",
    price: "۱۸۵,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1535585209827-a15fcdbc4c2d?q=80&w=2070",
    category: "پوست و مو",
    brand: "Cerita",
    details: {
      properties: [
        { label: "نوع محصول", value: "شامپو تقویت کننده" },
        { label: "حجم", value: "200 میلی لیتر" },
        { label: "ترکیبات کلیدی", value: "کافئین، ساوپالمتو" },
        { label: "مناسب برای", value: "انواع مو دارای ریزش" },
        { label: "کشور سازنده", value: "ایران" }
      ],
      features: [
        "افزایش گردش خون مویرگی در کف سر",
        "مهار آنزیم 5-آلفا ردوکتاز (عامل ریزش ارثی)",
        "افزایش ضخامت تارهای مو",
        "تنظیم چربی پوست سر",
        "حاوی ویتامین‌های B و E"
      ],
      usage: "مقداری از شامپو را روی موهای خیس ریخته و به مدت 2 تا 3 دقیقه ماساژ دهید، سپس آبکشی نمایید.",
      warnings: "فقط برای استعمال خارجی.",
      storage: "دور از دسترس کودکان و در دمای محیط نگهداری شود."
    }
  },
  {
    id: 9,
    name: "سرم ضد جوش نیاسینامید اوردینری",
    description: "کنترل چربی پوست و کاهش منافذ باز.",
    price: "۸۹۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1601049541289-9b1b7bbbfe19?q=80&w=1887",
    category: "پوست و مو",
    brand: "The Ordinary",
    details: {
      properties: [
        { label: "نام اصلی", value: "Niacinamide 10% + Zinc 1%" },
        { label: "حجم", value: "30 و 60 میلی لیتر" },
        { label: "نوع پوست", value: "چرب و مستعد جوش" },
        { label: "PH", value: "5.5 - 6.5" },
        { label: "کشور سازنده", value: "کانادا" }
      ],
      features: [
        "تنظیم ترشح سبوم (چربی پوست)",
        "کوچک کننده منافذ باز پوست",
        "کاهش التهاب و قرمزی جوش",
        "روشن کننده جای جوش (اسکار)",
        "فاقد الکل، چربی و گلوتن"
      ],
      usage: "صبح و شب قبل از کرم‌های سنگین و مرطوب کننده، چند قطره را روی کل صورت پخش کنید.",
      warnings: "همزمان با ویتامین C خالص استفاده نشود. در صورت بروز تحریک شدید، مصرف را قطع کنید.",
      storage: "در جای خشک و خنک و دور از نور مستقیم نگهداری شود."
    }
  },
  {
    id: 11,
    name: "کرم آبرسان و مرطوب کننده وچه",
    description: "مناسب پوست های خشک و معمولی، حاوی هیالورونیک اسید.",
    price: "۲۱۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1629198688000-71f23e745b6e?q=80&w=2000",
    category: "پوست و مو",
    brand: "Voche",
    details: {
        properties: [
            { label: "نوع محصول", value: "کرم آبرسان" },
            { label: "مناسب برای", value: "پوست خشک و معمولی" },
            { label: "حجم", value: "60 میلی لیتر" },
            { label: "ویتامین", value: "E" }
        ],
        features: [
            "آبرسانی عمیق و طولانی مدت",
            "جذب سریع بدون ایجاد چربی",
            "حاوی هیالورونیک اسید و روغن اینکا اینچی",
            "فاقد پارابن و سیلیکون"
        ],
        usage: "روزانه دو بار (صبح و شب) روی پوست تمیز صورت و گردن ماساژ دهید.",
        warnings: "از تماس با چشم خودداری شود.",
        storage: "در دمای محیط نگهداری شود."
    }
  },
  {
    id: 12,
    name: "تونر پاک کننده صورت سی گل",
    description: "حاوی ویتامین C، روشن کننده و پاک کننده عمیق منافذ.",
    price: "۱۲۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1551201802-14eb066d9b04?q=80&w=2000",
    category: "پوست و مو",
    brand: "Seagull",
    details: {
        properties: [
            { label: "نوع محصول", value: "تونر پاک کننده" },
            { label: "حجم", value: "150 میلی لیتر" },
            { label: "ماده شاخص", value: "ویتامین C" },
            { label: "مناسب برای", value: "انواع پوست" }
        ],
        features: [
            "تکمیل فرآیند پاکسازی پوست",
            "تنظیم PH پوست",
            "روشن کننده و شفاف کننده",
            "حاوی عصاره پرتقال و چای سبز"
        ],
        usage: "پس از شستشوی صورت، پد آرایشی را به تونر آغشته کرده و روی پوست بکشید. نیاز به آبکشی ندارد.",
        warnings: "روی زخم باز استفاده نشود. دور از دسترس کودکان نگهداری شود.",
        storage: "در جای خشک و خنک نگهداری شود."
    }
  },

  // محصولات آرایشی بهداشتی (Cosmetics)
  {
    id: 8,
    name: "مرطوب کننده و آبرسان قوی سیمپل",
    description: "بافت سبک بر پایه آب، بدون چربی، مناسب انواع پوست.",
    price: "۳۲۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1611930022073-b7a4ba5fcccd?q=80&w=1974",
    category: "محصولات آرایشی بهداشتی",
    brand: "Simple",
    details: {
      properties: [
        { label: "مدل", value: "Light Moisturiser" },
        { label: "حجم", value: "125 میلی لیتر" },
        { label: "بافت", value: "فلوئید سبک" },
        { label: "ماندگاری", value: "12 ساعت" },
        { label: "کشور مبدا برند", value: "انگلستان" }
      ],
      features: [
        "جذب بسیار سریع بدون ایجاد چربی",
        "حاوی ویتامین B5 و E",
        "مناسب پوست‌های حساس (بدون عطر و رنگ)",
        "پایه آب (Water Based)",
        "تست شده توسط متخصصین پوست"
      ],
      usage: "مقدار مناسبی از کرم را روی پوست تمیز صورت و گردن ماساژ دهید. قابل استفاده زیر آرایش.",
      warnings: "فقط برای استعمال خارجی.",
      storage: "در دمای اتاق نگهداری شود."
    }
  },
  {
    id: 13,
    name: "ریمل حجم دهنده اسنس",
    description: "حجم دهنده فوق‌العاده مژه‌ها، رنگ مشکی کاملا طبیعی.",
    price: "۲۸۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1631214503851-a712345e5440?q=80&w=2000",
    category: "محصولات آرایشی بهداشتی",
    brand: "Essence",
    details: {
        properties: [
            { label: "مدل", value: "I Love Extreme" },
            { label: "رنگ", value: "مشکی" },
            { label: "برس", value: "فیبری بزرگ" },
            { label: "ضد آب", value: "نیست" }
        ],
        features: [
            "حجم دهندگی فوق العاده",
            "بدون ایجاد چسبندگی مژه ها",
            "رنگدانه های مشکی غلیظ",
            "پاک شدن آسان"
        ],
        usage: "برس ریمل را از ریشه مژه ها به سمت نوک بکشید. برای حجم بیشتر، این کار را تکرار کنید.",
        warnings: "از پمپ کردن برس در محفظه خودداری کنید زیرا باعث خشک شدن ریمل می شود.",
        storage: "پس از استفاده درب محصول را محکم ببندید."
    }
  },
  {
    id: 14,
    name: "کرم پودر مات کالیستا",
    description: "پوشش دهی بالا، بافت سبک و مخملی، مناسب استفاده روزانه.",
    price: "۳۵۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1596462502278-27bfdd403cc2?q=80&w=2000",
    category: "محصولات آرایشی بهداشتی",
    brand: "Callista",
    details: {
        properties: [
            { label: "مدل", value: "Long Lasting" },
            { label: "نوع محفظه", value: "تیوپی" },
            { label: "حجم", value: "35 میلی لیتر" },
            { label: "پوشش", value: "مات و مخملی" }
        ],
        features: [
            "ماندگاری بالا",
            "بافت سبک بدون احساس سنگینی",
            "پوشش کامل لک ها و جای جوش",
            "مناسب انواع پوست"
        ],
        usage: "مقدار کمی از کرم پودر را روی صورت زده و با اسفنج یا براش مخصوص پخش کنید.",
        warnings: "دور از نور مستقیم خورشید نگهداری شود.",
        storage: "در جای خشک و خنک نگهداری شود."
    }
  },
  {
    id: 15,
    name: "رژ لب جامد این لی",
    description: "بدون سرب، حاوی مواد مرطوب کننده، ماندگاری بالا.",
    price: "۱۶۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1586495777744-4413f21062dc?q=80&w=2000",
    category: "محصولات آرایشی بهداشتی",
    brand: "Inlay",
    details: {
        properties: [
            { label: "نوع", value: "جامد مات" },
            { label: "وزن", value: "4 گرم" },
            { label: "SPF", value: "ندارد" },
            { label: "کشور سازنده", value: "ایران" }
        ],
        features: [
            "فاقد سرب و پارابن",
            "حاوی مواد مرطوب کننده لب",
            "پوشش دهی یکنواخت",
            "ماندگاری مناسب"
        ],
        usage: "رژ لب را وسط لب بالایی قرار داده و به سمت گوشه ها بکشید، سپس برای لب پایین تکرار کنید.",
        warnings: "در صورت بروز حساسیت مصرف را قطع کنید.",
        storage: "دور از تابش مستقیم آفتاب و گرما نگهداری شود."
    }
  },
  {
    id: 16,
    name: "میسلار واتر گارنیر",
    description: "پاک کننده آرایش صورت، چشم و لب، مناسب پوست حساس.",
    price: "۳۹۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1555677271-42790757d77b?q=80&w=2000",
    category: "محصولات آرایشی بهداشتی",
    brand: "Garnier",
    details: {
        properties: [
            { label: "مدل", value: "Pink (Sensitive Skin)" },
            { label: "حجم", value: "400 میلی لیتر" },
            { label: "مناسب برای", value: "پوست های حساس" },
            { label: "نوع", value: "محلول پاک کننده" }
        ],
        features: [
            "پاک کننده آرایش صورت، چشم و لب",
            "بدون نیاز به آبکشی",
            "فاقد عطر و الکل",
            "تسکین دهنده پوست"
        ],
        usage: "پد پنبه ای را به محلول آغشته کرده و به آرامی روی پوست بکشید تا آرایش پاک شود.",
        warnings: "از ورود مستقیم مایع به داخل چشم خودداری شود.",
        storage: "در دمای اتاق نگهداری شود."
    }
  },

  // مکمل های غذایی دارویی (Supplements)
  {
    id: 3,
    name: "قرص کلاژن گلد (Collagen Gold)",
    description: "کمک به سلامت پوست، مو و ناخن، کاهش چین و چروک.",
    price: "۹۸۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1584308666744-24d5c474f2ae?q=80&w=2000",
    category: "مکمل های غذایی دارویی",
    brand: "Adian",
    details: {
      properties: [
        { label: "تعداد در بسته", value: "60 عدد" },
        { label: "نوع کلاژن", value: "هیدرولیز شده نوع 1 و 3" },
        { label: "دوز کلاژن", value: "833 میلی گرم در هر قرص" },
        { label: "سایر ترکیبات", value: "ویتامین C، هیالورونیک اسید" },
        { label: "کشور سازنده", value: "ایران (تحت لیسانس)" }
      ],
      features: [
        "افزایش خاصیت ارتجاعی پوست",
        "کاهش عمق چین و چروک‌ها",
        "تقویت ضخامت مو و استحکام ناخن",
        "بهبود آبرسانی پوست",
        "فاقد شکر و مواد نگهدارنده مضر"
      ],
      usage: "روزانه 3 عدد قرص به مدت حداقل 4 تا 12 هفته مصرف شود. بهترین زمان مصرف شب قبل از خواب است.",
      warnings: "در دوران بارداری و شیردهی با مشورت پزشک مصرف شود. در صورت نارسایی کلیوی با احتیاط مصرف شود.",
      storage: "در جای خشک و خنک و در دمای زیر 30 درجه سانتی گراد نگهداری شود."
    }
  },
  {
    id: 7,
    name: "کپسول هیرتامین (Hairtamin)",
    description: "تقویت کننده قوی مو، جلوگیری از ریزش.",
    price: "۱,۶۰۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1550572017-edd951aa8f72?q=80&w=1974",
    category: "مکمل های غذایی دارویی",
    brand: "Hairtamin",
    details: {
        properties: [
            { label: "تعداد", value: "30 عدد (مصرف یک ماه)" },
            { label: "ترکیبات", value: "بیوتین، زینک، زردچوبه، فلفل سیاه" },
            { label: "کشور سازنده", value: "آمریکا" },
            { label: "نوع", value: "Advanced Formula" }
        ],
        features: [
            "توقف ریزش مو و افزایش رشد مجدد",
            "ضخیم کننده تارهای مو",
            "فاقد گلوتن، مواد نگهدارنده و آلرژن",
            "مناسب برای انواع مو (مردان و زنان)"
        ],
        usage: "روزانه یک عدد کپسول همراه با غذا میل شود.",
        warnings: "بیش از دوز توصیه شده مصرف نشود. افراد زیر 18 سال با مشورت پزشک مصرف کنند.",
        storage: "در جای خشک، خنک و دور از دسترس کودکان نگهداری شود."
    }
  },
  {
    id: 17,
    name: "قرص جوشان ویتامین C یوروویتال",
    description: "تقویت سیستم ایمنی، جذب سریع، طعم پرتقالی.",
    price: "۸۵,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1617109033379-679905c14902?q=80&w=2000",
    category: "مکمل های غذایی دارویی",
    brand: "Eurho Vital",
    details: {
        properties: [
            { label: "دوز", value: "1000 میلی گرم" },
            { label: "تعداد", value: "20 عدد" },
            { label: "طعم", value: "پرتقال" },
            { label: "کشور سازنده", value: "آلمان (بسته بندی ایران)" }
        ],
        features: [
            "تقویت سیستم ایمنی بدن",
            "کمک به کلاژن سازی",
            "آنتی اکسیدان قوی",
            "جذب سریع و آسان"
        ],
        usage: "روزانه یک قرص را در یک لیوان آب حل کرده و میل نمایید.",
        warnings: "در بیماران دیابتی و سنگ کلیه با احتیاط و مشورت پزشک مصرف شود.",
        storage: "در دمای زیر 25 درجه سانتی گراد و در قوطی بسته نگهداری شود."
    }
  },
  {
    id: 18,
    name: "کپسول امگا 3 زهراوی",
    description: "حفظ سلامت قلب و عروق، کاهش کلسترول.",
    price: "۱۴۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1550572017-4fcdbb56321f?q=80&w=2000",
    category: "مکمل های غذایی دارویی",
    brand: "Zahravi",
    details: {
        properties: [
            { label: "تعداد", value: "50 عدد" },
            { label: "دوز", value: "1000 میلی گرم روغن ماهی" },
            { label: "EPA/DHA", value: "180/120 میلی گرم" },
            { label: "نوع ژلاتین", value: "حلال" }
        ],
        features: [
            "کمک به سلامت قلب و عروق",
            "کاهش تری گلیسیرید خون",
            "ضد التهاب مفاصل",
            "بهبود عملکرد مغز"
        ],
        usage: "روزانه یک تا دو عدد کپسول همراه با غذا و آب کافی میل شود.",
        warnings: "افرادی که داروهای رقیق کننده خون (مثل وارفارین) مصرف می کنند باید با پزشک مشورت کنند.",
        storage: "در دمای کمتر از 25 درجه و دور از نور و رطوبت نگهداری شود."
    }
  },

  // مکمل های ورزشی (Sports)
  {
    id: 4,
    name: "پودر پروتئین وی کاله (۲۲۷۰ گرم)",
    description: "خلوص بالا، طعم شکلاتی، مناسب عضله سازی.",
    price: "۳,۴۰۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1579722821273-0f6c7d44362f?q=80&w=1887",
    category: "مکمل های ورزشی",
    brand: "Kalleh",
    details: {
      properties: [
        { label: "وزن", value: "2270 گرم (5 پوند)" },
        { label: "طعم", value: "شکلاتی" },
        { label: "پروتئین در هر سروینگ", value: "24 گرم" },
        { label: "BCAA", value: "5 گرم در هر سروینگ" },
        { label: "کشور سازنده", value: "ایران" }
      ],
      features: [
        "پروتئین وی کنسانتره با کیفیت بالا",
        "فاقد شکر افزوده",
        "حلالیت بسیار عالی",
        "کمک به رشد و ریکاوری عضلات",
        "حاوی آنزیم‌های هضم کننده برای جذب بهتر"
      ],
      usage: "یک پیمانه (30 گرم) را با 250 میلی لیتر آب یا شیر مخلوط کرده و بلافاصله بعد از تمرین میل کنید.",
      warnings: "افراد دارای نارسایی کلیوی یا کبدی قبل از مصرف با پزشک مشورت کنند. بیش از دوز توصیه شده مصرف نشود.",
      storage: "در جای خشک و خنک نگهداری شود. درب قوطی پس از مصرف بسته شود."
    }
  },
  {
    id: 19,
    name: "کراتین مونوهیدرات پی ان سی",
    description: "افزایش قدرت و حجم عضلات، ۳۰۰ گرمی.",
    price: "۵۵۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1593095948071-474c5cc2989d?q=80&w=2000",
    category: "مکمل های ورزشی",
    brand: "PNC",
    details: {
        properties: [
            { label: "وزن", value: "300 گرم" },
            { label: "نوع", value: "مونوهیدرات خالص" },
            { label: "شرکت سازنده", value: "کارن (PNC)" },
            { label: "طعم", value: "بدون طعم" }
        ],
        features: [
            "افزایش قدرت و استقامت عضلانی",
            "کمک به عضله سازی سریع تر",
            "بهبود ریکاوری بین ست های تمرینی",
            "خلوص بالا و جذب عالی"
        ],
        usage: "دوره بارگیری: 5 روز، روزی 20 گرم (4 وعده 5 گرمی). دوره نگهداری: روزی 5 گرم قبل یا بعد از تمرین.",
        warnings: "در طول مصرف آب فراوان بنوشید. افراد زیر 18 سال و سالمندان با مشورت پزشک مصرف کنند.",
        storage: "درب قوطی را پس از مصرف محکم ببندید و در جای خشک نگهداری کنید."
    }
  },
  {
    id: 20,
    name: "گینر سریوس مس اپتیموم",
    description: "افزایش وزن سریع، کربوهیدرات و پروتئین بالا.",
    price: "۴,۲۰۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1579722820308-d74e571900a9?q=80&w=2000",
    category: "مکمل های ورزشی",
    brand: "ON",
    details: {
        properties: [
            { label: "وزن", value: "2.7 کیلوگرم" },
            { label: "کالری", value: "1250 در هر سروینگ" },
            { label: "پروتئین", value: "50 گرم در هر سروینگ" },
            { label: "نسبت کربوهیدرات به پروتئین", value: "5 به 1" }
        ],
        features: [
            "مناسب برای افراد اکتومورف (بسیار لاغر)",
            "حاوی 25 نوع ویتامین و مواد معدنی",
            "غنی شده با کراتین و گلوتامین",
            "طعم و حلالیت عالی"
        ],
        usage: "دو پیمانه سرپر را با 700 میلی لیتر آب مخلوط کرده و در وعده های مختلف (صبح، بعد تمرین) میل کنید.",
        warnings: "افراد دیابتی قبل از مصرف با پزشک مشورت کنند. ممکن است باعث افزایش توده چربی در صورت عدم تمرین شود.",
        storage: "در جای خشک و خنک نگهداری شود."
    }
  },

  // مادر و کودک (Mom & Baby)
  {
    id: 6,
    name: "شیر خشک آپتامیل ۱ نوتریشیا",
    description: "حاوی پره بیوتیک، مناسب بدو تولد تا ۶ ماهگی.",
    price: "۱۵۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1632053001869-7c8fa07137b0?q=80&w=2070",
    category: "مادر و کودک",
    brand: "Aptamil",
    details: {
      properties: [
        { label: "رده سنی", value: "از بدو تولد تا 6 ماهگی" },
        { label: "وزن", value: "400 گرم" },
        { label: "نوع محفظه", value: "قوطی فلزی" },
        { label: "برند", value: "نوتریشیا (Nutricia)" },
        { label: "ساخت", value: "ایران (تحت لیسانس)" }
      ],
      features: [
        "حاوی پره بیوتیک های scGOS/lcFOS",
        "غنی شده با آهن، امگا 3 و امگا 6 (LCPs)",
        "طعم و ترکیبات نزدیک به شیر مادر",
        "تقویت سیستم ایمنی نوزاد",
        "کمک به رشد باکتری های مفید روده"
      ],
      usage: "طبق جدول تغذیه روی قوطی، آب جوشیده سرد شده را با پیمانه مخصوص مخلوط کنید.",
      warnings: "شیر آماده شده باید ظرف مدت 1 ساعت مصرف شود. باقیمانده شیر را دور بریزید.",
      storage: "در جای خشک و خنک (خارج از یخچال) نگهداری شود و تا 4 هفته پس از باز شدن مصرف گردد."
    }
  },
  {
    id: 21,
    name: "پوشک مای بیبی سایز 4",
    description: "بسته 34 عددی، قدرت جذب بالا، ضد حساسیت.",
    price: "۲۳۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1551806371-d648b26500b5?q=80&w=2000",
    category: "مادر و کودک",
    brand: "My Baby",
    details: {
        properties: [
            { label: "سایز", value: "4 (بزرگ)" },
            { label: "تعداد در بسته", value: "34 عدد" },
            { label: "مناسب وزن", value: "10 تا 18 کیلوگرم" },
            { label: "برند", value: "مای بیبی" }
        ],
        features: [
            "حاوی لوسیون با عصاره بابونه",
            "قدرت جذب بسیار بالا",
            "لایه بیرونی تنفسی برای عبور هوا",
            "چسب های مکانیکی و قابل تنظیم"
        ],
        usage: "پوشک را زیر کودک قرار داده و چسب ها را به اندازه دور کمر تنظیم کنید.",
        warnings: "در صورت مشاهده حساسیت پوستی، برند پوشک را تغییر دهید یا با پزشک مشورت کنید.",
        storage: "در جای خشک نگهداری شود."
    }
  },
  {
    id: 22,
    name: "شیشه شیر اونت (Avent)",
    description: "ضد نفخ، سر شیشه مشابه سینه مادر، ۱۲۵ میلی لیتر.",
    price: "۵۸۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1595240366657-b060d4182902?q=80&w=2000",
    category: "مادر و کودک",
    brand: "Philips Avent",
    details: {
        properties: [
            { label: "گنجایش", value: "125 میلی لیتر" },
            { label: "جنس بدنه", value: "پلی پروپیلن (طلقی)" },
            { label: "نوع سر شیشه", value: "سیلیکونی نرم (شماره 1)" },
            { label: "BPA", value: "Free (فاقد مواد مضر)" }
        ],
        features: [
            "سیستم ضد نفخ (Anti-Colic) پیشرفته",
            "طراحی ارگونومیک برای نگهداری آسان",
            "سر شیشه گلبرگی مشابه سینه مادر",
            "شستشو و مونتاژ آسان"
        ],
        usage: "قبل از اولین استفاده، قطعات را 5 دقیقه در آب جوش استریل کنید. پس از هر بار مصرف کاملا بشویید.",
        warnings: "از گرم کردن شیر در مایکروویو خودداری کنید (خطر سوختگی نوزاد).",
        storage: "در جای تمیز و خشک نگهداری شود."
    }
  },

  // ارتوپدی (Orthopedic)
  {
    id: 10,
    name: "مچ بند آتل دار پاک سمن",
    description: "تثبیت کننده مچ دست، مناسب سندروم تونل کارپال.",
    price: "۲۸۵,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?q=80&w=2070",
    category: "محصولات ارتوپدی",
    brand: "Paksaman",
    details: {
      properties: [
        { label: "سایز", value: "فری سایز (قابل تنظیم)" },
        { label: "جنس", value: "نئوپرن ضد حساسیت" },
        { label: "نوع آتل", value: "آلومینیومی سخت" },
        { label: "کاربرد", value: "مچ دست (راست/چپ)" },
        { label: "برند", value: "پاک سمن" }
      ],
      features: [
        "حمایت کامل از مفصل مچ دست",
        "کاهش درد و التهاب تاندون‌ها",
        "مناسب برای درمان سندرم تونل کارپال (CTS)",
        "قابل شستشو (با دست)",
        "سبک و راحت برای استفاده طولانی مدت"
      ],
      usage: "آتل را در کف دست قرار داده و بندها را متناسب با سایز مچ محکم کنید. استفاده در شب هنگام خواب توصیه می‌شود.",
      warnings: "از سفت بستن بیش از حد که باعث قطع گردش خون شود خودداری کنید.",
      storage: "با آب سرد شسته شود و از حرارت مستقیم دور نگه داشته شود."
    }
  },
  {
    id: 23,
    name: "زانوبند کشکک باز طب و صنعت",
    description: "حمایت از مفصل زانو، نئوپرن ضد حساسیت.",
    price: "۳۴۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1594953932675-8025287f3b52?q=80&w=2000",
    category: "محصولات ارتوپدی",
    brand: "Teb & Sanat",
    details: {
        properties: [
            { label: "سایز", value: "L, XL" },
            { label: "جنس", value: "نئوپرن" },
            { label: "مدل", value: "کشکک باز" },
            { label: "نوع", value: "قابل تنظیم" }
        ],
        features: [
            "حمایت از مفصل زانو و کشکک",
            "حفظ گرمای موضعی برای کاهش درد",
            "جلوگیری از جابجایی کشکک",
            "کاهش فشار روی زانو"
        ],
        usage: "زانوبند را طوری ببندید که سوراخ آن روی کشکک زانو قرار گیرد و چسب ها را محکم کنید.",
        warnings: "در صورت افزایش درد یا تورم، استفاده را قطع و با پزشک مشورت کنید.",
        storage: "با آب سرد و صابون شسته شود. از اتو کردن و حرارت دادن خودداری شود."
    }
  },

  // تجهیزات پزشکی (Medical Equipment) - NEW CATEGORY
  {
    id: 30,
    name: "فشارسنج دیجیتال بازویی بیورر (Beurer)",
    description: "دقت بالا، دارای حافظه داخلی و تشخیص آریتمی.",
    price: "۲,۸۵۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1631549916768-4119b2e5f926?q=80&w=2079",
    category: "تجهیزات پزشکی",
    brand: "Beurer",
    details: {
        properties: [
            { label: "مدل", value: "BM47" },
            { label: "نوع", value: "بازویی تمام اتوماتیک" },
            { label: "منبع تغذیه", value: "4 عدد باتری قلمی" },
            { label: "سایز کاف", value: "22 تا 35 سانتی متر" }
        ],
        features: [
            "تشخیص آریتمی (بی نظمی ضربان قلب)",
            "نمایشگر بزرگ و خوانا با نور پس زمینه",
            "محاسبه میانگین فشار خون صبح و شب",
            "خاموشی خودکار برای صرفه جویی در باتری"
        ],
        usage: "کاف را روی بازوی برهنه (حدود 2 سانتیمتر بالاتر از آرنج) ببندید، دست را روی تکیه گاه قرار داده و دکمه استارت را فشار دهید.",
        warnings: "در حین اندازه گیری صحبت نکنید و حرکت نکنید. قبل از اندازه گیری 5 دقیقه استراحت کنید.",
        storage: "در کیف مخصوص و دور از رطوبت و ضربه نگهداری شود."
    }
  },
  {
    id: 31,
    name: "تب سنج دیجیتال غیر تماسی",
    description: "اندازه گیری دما در کمتر از 1 ثانیه بدون تماس با پوست.",
    price: "۹۸۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1584634731339-252c581abfc5?q=80&w=2070",
    category: "تجهیزات پزشکی",
    brand: "Xiaomi",
    details: {
        properties: [
            { label: "دقت", value: "0.2 درجه سانتی گراد" },
            { label: "فاصله اندازه گیری", value: "3 تا 5 سانتی متر" },
            { label: "واحد نمایش", value: "سانتی گراد / فارنهایت" },
            { label: "هشدار تب", value: "دارد (بوق هشدار)" }
        ],
        features: [
            "سنسور مادون قرمز دقیق ژاپنی",
            "مناسب برای نوزادان و بزرگسالان",
            "قابلیت اندازه گیری دمای اجسام و مایعات",
            "طراحی ارگونومیک و سبک"
        ],
        usage: "دستگاه را در فاصله 3 سانتی متری وسط پیشانی نگه داشته و دکمه اندازه گیری را فشار دهید.",
        warnings: "لنز سنسور را تمیز نگه دارید. در محیط با تغییرات دمایی شدید استفاده نشود.",
        storage: "بدون باتری در جعبه مخصوص نگهداری شود."
    }
  },
  {
    id: 32,
    name: "پالس اکسیمتر انگشتی (سنجش اکسیژن خون)",
    description: "نمایش درصد اشباع اکسیژن خون (SpO2) و ضربان قلب.",
    price: "۴۲۰,۰۰۰ تومان",
    image: "https://images.unsplash.com/photo-1584017911766-d451b3d0e843?q=80&w=2069",
    category: "تجهیزات پزشکی",
    brand: "Berry",
    details: {
        properties: [
            { label: "نوع نمایشگر", value: "OLED رنگی" },
            { label: "دامنه سنجش", value: "70% تا 100%" },
            { label: "چرخش تصویر", value: "4 جهته" },
            { label: "وزن", value: "50 گرم (با باتری)" }
        ],
        features: [
            "مصرف باتری بسیار پایین",
            "خاموشی خودکار پس از 8 ثانیه عدم استفاده",
            "نمایش گرافیکی ضربان قلب (Plethysmogram)",
            "مناسب استفاده خانگی و کلینیکی"
        ],
        usage: "گیره را باز کرده، انگشت اشاره را کاملا داخل دستگاه قرار دهید و دکمه روشن را بزنید.",
        warnings: "ناخن انگشت نباید لاک یا ناخن مصنوعی داشته باشد. دست سرد نباشد.",
        storage: "دور از ضربه شدید و مایعات نگهداری شود."
    }
  }
];

const MOCK_POSTS: BlogPost[] = [
  {
    id: '1',
    title: 'همه چیز درباره ضدآفتاب‌های SPF50 و تاثیر آنها بر پوست چرب',
    excerpt: 'انتخاب ضدآفتاب مناسب برای پوست‌های چرب همیشه چالش‌برانگیز است. در این مقاله به بررسی تاثیر SPF50 و ترکیبات موثر در کرم‌های لافارر می‌پردازیم.',
    content: `پوست چرب یکی از حساس‌ترین انواع پوست در برابر اشعه‌های مضر خورشید است. چربی اضافه می‌تواند باعث گرفتگی منافذ و ایجاد جوش شود، به همین دلیل انتخاب ضدآفتاب مناسب حیاتی است.
    
    ضدآفتاب‌های لافارر با فرمولاسیون فاقد چربی (Oil-Free) نه تنها از پوست محافظت می‌کنند، بلکه با داشتن عصاره‌های گیاهی مثل شیرین‌بیان و بیربری، به تنظیم ترشح چربی و روشن‌شدن لک‌های پوستی کمک می‌کنند.
    
    SPF50 به این معناست که پوست شما ۵۰ برابر بیشتر از حالت عادی در برابر سوختگی مقاومت دارد. این عدد برای شرایط آب و هوایی ایران بسیار مناسب است. نکته مهم در مصرف ضدآفتاب، تمدید آن هر ۲ ساعت یکبار است، به‌ویژه اگر در معرض نور مستقیم یا تعریق زیاد هستید.`,
    image: 'https://images.unsplash.com/photo-1526947425960-945c6e72858f?q=80&w=2070&auto=format&fit=crop',
    author: 'دکتر شمیم نسب',
    authorRole: 'دکترای داروسازی',
    date: '۱۴۰۲/۱۱/۱۰',
    readTime: '۵ دقیقه',
    category: 'پوست و مو',
    relatedProductId: 1
  },
  {
    id: '2',
    title: 'معجزه کلاژن برای جوانسازی پوست: واقعیت یا تبلیغ؟',
    excerpt: 'آیا قرص‌های کلاژن واقعاً تاثیرگذار هستند؟ بررسی علمی تاثیر مکمل‌های کلاژن بر کاهش چین و چروک و سلامت مو و ناخن.',
    content: `با افزایش سن، تولید کلاژن طبیعی در بدن کاهش می‌یابد که منجر به افتادگی پوست و ایجاد چین و چروک می‌شود. مکمل‌های کلاژن هیدرولیز شده، مانند کلاژن گلد، حاوی پپتیدهای کوچکی هستند که جذب بسیار بالایی دارند.
    
    مطالعات نشان داده‌اند که مصرف منظم کلاژن به مدت ۸ تا ۱۲ هفته می‌تواند رطوبت پوست را افزایش داده و عمق چروک‌ها را کاهش دهد. همچنین، کلاژن جزء اصلی ساختار مو و ناخن است و مصرف آن به استحکام و درخشندگی آنها کمک می‌کند.
    
    بهترین زمان مصرف کلاژن، شب‌ها قبل از خواب یا صبح ناشتا است تا جذب حداکثری داشته باشد.`,
    image: 'https://images.unsplash.com/photo-1596704017235-dca31dc7120e?q=80&w=2070&auto=format&fit=crop',
    author: 'دکتر علی علوی',
    authorRole: 'متخصص تغذیه',
    date: '۱۴۰۲/۱۱/۰۵',
    readTime: '۴ دقیقه',
    category: 'مکمل دارویی',
    relatedProductId: 3
  },
  {
    id: '3',
    title: 'راهنمای جامع مصرف پروتئین وی برای ورزشکاران',
    excerpt: 'چه زمانی پروتئین وی مصرف کنیم؟ تفاوت کنسانتره و ایزوله چیست؟ راهنمای کامل برای عضله‌سازی بهتر.',
    content: `پروتئین وی یکی از کامل‌ترین منابع پروتئینی است که تمامی اسیدهای آمینه ضروری بدن را تامین می‌کند. پروتئین وی کاله با خلوص بالا، انتخابی عالی برای ریکاوری سریع عضلات بعد از تمرینات سنگین است.
    
    بهترین زمان مصرف بلافاصله بعد از تمرین است، زیرا در این زمان عضلات بیشترین نیاز را به مواد مغذی برای بازسازی دارند. همچنین مصرف آن در صبح ناشتا برای توقف کاتابولیسم شبانه توصیه می‌شود.`,
    image: 'https://images.unsplash.com/photo-1579722821273-0f6c7d44362f?q=80&w=1887&auto=format&fit=crop',
    author: 'دکتر سارا محمدی',
    authorRole: 'متخصص پزشکی ورزشی',
    date: '۱۴۰۲/۱۰/۲۰',
    readTime: '۶ دقیقه',
    category: 'ورزشی',
    relatedProductId: 4
  },
  {
    id: '4',
    title: 'توقف ریزش مو با قدرت کافئین: بررسی علمی شامپو سریتا',
    excerpt: 'کافئین چگونه بر فولیکول‌های مو تاثیر می‌گذارد؟ آیا شامپوهای کافئین‌دار واقعاً از ریزش موی ارثی جلوگیری می‌کنند؟',
    content: `ریزش موی آندروژنیک یکی از شایع‌ترین مشکلات در بین آقایان و خانم‌هاست. تحقیقات نشان داده که کافئین می‌تواند اثرات منفی هورمون دی‌هیدروتستوسترون (DHT) را خنثی کرده و فاز رشد مو را طولانی‌تر کند.
    
    شامپو ضد ریزش سریتا با داشتن کافئین کپسوله شده، نفوذپذیری بالایی به ریشه مو دارد. این محصول علاوه بر کافئین، حاوی عصاره ساوپالمتو است که یک مهارکننده طبیعی آنزیم ۵-آلفا ردوکتاز محسوب می‌شود.
    
    برای گرفتن بهترین نتیجه، توصیه می‌شود کف شامپو حداقل ۳ دقیقه روی سر بماند تا ترکیبات فعال آن فرصت جذب داشته باشند.`,
    image: 'https://images.unsplash.com/photo-1535585209827-a15fcdbc4c2d?q=80&w=2070&auto=format&fit=crop',
    author: 'دکتر مریم راد',
    authorRole: 'متخصص پوست و مو',
    date: '۱۴۰۲/۱۰/۲۸',
    readTime: '۵ دقیقه',
    category: 'پوست و مو',
    relatedProductId: 5
  },
  {
    id: '5',
    title: 'خداحافظی با جوش‌های زیرپوستی با معجزه نیاسینامید',
    excerpt: 'نیاسینامید چیست و چرا باید در روتین پوستی شما باشد؟ بررسی سرم اوردینری برای پوست‌های مستعد آکنه.',
    content: `نیاسینامید یا ویتامین B3 یکی از محبوب‌ترین ترکیبات در دنیای مراقبت از پوست است. این ماده با تنظیم ترشح چربی (سبوم) پوست، از بسته شدن منافذ و ایجاد جوش جلوگیری می‌کند.
    
    سرم نیاسینامید ۱۰٪ اوردینری نه تنها جوش‌ها را کنترل می‌کند، بلکه به مرور زمان لک‌های ناشی از جوش (اسکار آکنه) را نیز کمرنگ می‌کند. وجود زینک در این سرم به تسکین التهابات پوستی کمک شایانی می‌کند.
    
    نکته مهم: اگر پوست حساسی دارید، ابتدا با غلظت‌های کمتر شروع کنید یا سرم را به صورت یک شب در میان استفاده نمایید.`,
    image: 'https://images.unsplash.com/photo-1601049541289-9b1b7bbbfe19?q=80&w=1887&auto=format&fit=crop',
    author: 'دکتر مینا سعیدی',
    authorRole: 'داروساز',
    date: '۱۴۰۲/۱۱/۰۲',
    readTime: '۴ دقیقه',
    category: 'پوست و مو',
    relatedProductId: 9
  },
  {
    id: '6',
    title: 'همه چیز درباره شیرخشک آپتامیل و سیستم ایمنی نوزاد',
    excerpt: 'چرا شیرخشک آپتامیل شبیه‌ترین فرمولاسیون به شیر مادر را دارد؟ نقش پره‌بیوتیک‌ها در سلامت گوارش کودک.',
    content: `تغذیه نوزاد در ماه‌های اول زندگی پایه‌گذار سلامت او در آینده است. شیرخشک آپتامیل با داشتن ترکیبات پره‌بیوتیک (GOS/FOS)، به رشد باکتری‌های مفید روده کمک کرده و سیستم ایمنی نوزاد را تقویت می‌کند.
    
    این شیرخشک همچنین حاوی اسیدهای چرب ضروری AA و DHA است که برای تکامل مغز و بینایی نوزاد حیاتی هستند. اگر نوزاد شما دچار کولیک یا آلرژی نیست، آپتامیل ساده یکی از بهترین گزینه‌ها برای جایگزینی یا مکمل شیر مادر است.`,
    image: 'https://images.unsplash.com/photo-1632053001869-7c8fa07137b0?q=80&w=2070&auto=format&fit=crop',
    author: 'دکتر حسین تهرانی',
    authorRole: 'متخصص اطفال',
    date: '۱۴۰۲/۱۰/۱۵',
    readTime: '۶ دقیقه',
    category: 'مادر و کودک',
    relatedProductId: 6
  },
  {
    id: '7',
    title: 'ویتامین C: فراتر از یک تقویت‌کننده سیستم ایمنی',
    excerpt: 'چرا ورزشکاران و افراد سیگاری به ویتامین C بیشتری نیاز دارند؟ بررسی قرص جوشان یوروویتال.',
    content: `همه ما ویتامین C را با سرماخوردگی می‌شناسیم، اما این ویتامین نقش‌های بسیار مهم‌تری دارد. ویتامین C یک آنتی‌اکسیدان قوی است که از سلول‌ها در برابر استرس اکسیداتیو محافظت می‌کند.
    
    این ویتامین برای ساخت کلاژن ضروری است، بنابراین کمبود آن می‌تواند منجر به پیری زودرس پوست و دیر خوب شدن زخم‌ها شود. ورزشکاران به دلیل فعالیت بدنی شدید و تولید رادیکال‌های آزاد، نیاز بیشتری به این ویتامین دارند.
    
    قرص جوشان یوروویتال با دوز مناسب و جذب سریع، گزینه‌ای عالی برای تامین نیاز روزانه است.`,
    image: 'https://images.unsplash.com/photo-1617109033379-679905c14902?q=80&w=2000&auto=format&fit=crop',
    author: 'دکتر زهرا کیانی',
    authorRole: 'متخصص تغذیه',
    date: '۱۴۰۲/۱۱/۱۲',
    readTime: '۳ دقیقه',
    category: 'مکمل دارویی',
    relatedProductId: 17
  },
  {
    id: '8',
    title: 'راز پاکسازی دو مرحله‌ای پوست با میسلار واتر',
    excerpt: 'چرا شستن صورت با آب و صابون کافی نیست؟ اهمیت استفاده از میسلار واتر قبل از شوینده.',
    content: `آلاینده‌های هوا، ضدآفتاب و مواد آرایشی اغلب با شوینده‌های معمولی به طور کامل پاک نمی‌شوند و در منافذ باقی می‌مانند. این موضوع به مرور باعث کدری پوست و ایجاد جوش می‌شود.
    
    میسلار واتر گارنیر حاوی ذرات میسل است که مانند آهنربا آلودگی‌ها و چربی‌ها را به خود جذب می‌کند. استفاده از این محصول به عنوان مرحله اول پاکسازی (Double Cleansing)، پوست را کاملاً تمیز کرده و آماده جذب سرم‌ها و کرم‌ها می‌کند.
    
    این محصول نیاز به آبکشی ندارد و برای انواع پوست، حتی پوست‌های حساس مناسب است.`,
    image: 'https://images.unsplash.com/photo-1555677271-42790757d77b?q=80&w=2000&auto=format&fit=crop',
    author: 'مهسا ایرانی',
    authorRole: 'بیوتی تراپیست',
    date: '۱۴۰۲/۱۰/۲۵',
    readTime: '۴ دقیقه',
    category: 'آرایشی بهداشتی',
    relatedProductId: 16
  },
  {
    id: '9',
    title: 'سندرم تونل کارپال چیست و چگونه درمان می‌شود؟',
    excerpt: 'آیا درد مچ دست شما ناشی از کار با کامپیوتر است؟ نقش مچ‌بندهای آتل‌دار در بهبود درد.',
    content: `سندرم تونل کارپال ناشی از فشار بر عصب مدیان در مچ دست است که با علائمی مثل گزگز، بی‌حسی و درد در انگشتان همراه است. این مشکل در بین تایپیست‌ها، کاربران کامپیوتر و کسانی که حرکات تکراری دست دارند شایع است.
    
    استفاده از مچ‌بند آتل‌دار پاک سمن، با ثابت نگه داشتن مچ در وضعیت خنثی، فشار را از روی عصب برداشته و به کاهش التهاب کمک می‌کند. استفاده شبانه از این مچ‌بند اغلب اولین خط درمان توصیه شده توسط پزشکان است.`,
    image: 'https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?q=80&w=2070&auto=format&fit=crop',
    author: 'دکتر امیررضا پناهی',
    authorRole: 'فیزیوتراپیست',
    date: '۱۴۰۲/۱۱/۰۸',
    readTime: '۵ دقیقه',
    category: 'ارتوپدی',
    relatedProductId: 10
  },
  {
    id: '10',
    title: 'افزایش وزن اصولی با گینر: بایدها و نبایدها',
    excerpt: 'تفاوت گینر و پروتئین وی چیست؟ چگونه بدون چربی شکمی وزن اضافه کنیم؟',
    content: `برای کسانی که تیپ بدنی اکتومورف (لاغر اندام) دارند، افزایش وزن می‌تواند چالش‌برانگیز باشد. گینرها مکمل‌هایی هستند که علاوه بر پروتئین، مقادیر بالایی کربوهیدرات دارند تا کالری مازاد مورد نیاز بدن را تامین کنند.
    
    گینر سریوس مس اپتیموم یکی از باکیفیت‌ترین گینرهای بازار است که نسبت مناسبی از کربوهیدرات به پروتئین دارد. نکته کلیدی در مصرف گینر، همراهی آن با تمرینات بدنسازی است؛ در غیر این صورت کالری اضافی تبدیل به چربی شکمی خواهد شد.`,
    image: 'https://images.unsplash.com/photo-1579722820308-d74e571900a9?q=80&w=2000&auto=format&fit=crop',
    author: 'علی کریمی',
    authorRole: 'مربی بدنسازی',
    date: '۱۴۰۲/۱۰/۳۰',
    readTime: '۵ دقیقه',
    category: 'ورزشی',
    relatedProductId: 20
  },
  {
    id: '11',
    title: 'امگا ۳: دوست قلب و دشمن التهاب',
    excerpt: 'چرا باید امگا ۳ مصرف کنیم؟ تاثیر روغن ماهی بر سلامت قلب، مغز و مفاصل.',
    content: `اسیدهای چرب امگا ۳ چربی‌های ضروری هستند که بدن قادر به تولید آنها نیست. این ترکیبات نقش مهمی در کاهش تری‌گلیسیرید خون، تنظیم فشار خون و پیشگیری از بیماری‌های قلبی دارند.
    
    علاوه بر سلامت قلب، امگا ۳ خاصیت ضدالتهابی قوی دارد و می‌تواند به کاهش دردهای مفصلی در بیماران آرتروز کمک کند. کپسول امگا ۳ زهراوی با جیوه تصفیه شده، گزینه‌ای ایمن و موثر برای تامین این ماده حیاتی است.`,
    image: 'https://images.unsplash.com/photo-1550572017-4fcdbb56321f?q=80&w=2000&auto=format&fit=crop',
    author: 'دکتر لیلا صادقی',
    authorRole: 'داروساز بالینی',
    date: '۱۴۰۲/۱۱/۱۵',
    readTime: '۴ دقیقه',
    category: 'مکمل دارویی',
    relatedProductId: 18
  },
  {
    id: '12',
    title: 'راهنمای انتخاب پوشک مناسب برای پوست حساس نوزاد',
    excerpt: 'چگونه از ادرار سوختگی جلوگیری کنیم؟ ویژگی‌های یک پوشک خوب چیست؟',
    content: `پوست نوزاد بسیار نازک و حساس است و تماس طولانی مدت با رطوبت می‌تواند باعث ایجاد راش (ادرار سوختگی) شود. انتخاب پوشک با قدرت جذب بالا و لایه داخلی نرم بسیار مهم است.
    
    پوشک مای بیبی با تکنولوژی عبور هوا و لایه کتان، از تعریق و حساسیت جلوگیری می‌کند. همچنین تعویض به موقع پوشک و استفاده از کرم‌های محافظت کننده در هر بار تعویض، کلید داشتن پوستی سالم برای نوزاد است.`,
    image: 'https://images.unsplash.com/photo-1551806371-d648b26500b5?q=80&w=2000&auto=format&fit=crop',
    author: 'مریم نوری',
    authorRole: 'کارشناس مامایی',
    date: '۱۴۰۲/۱۱/۰۱',
    readTime: '۴ دقیقه',
    category: 'مادر و کودک',
    relatedProductId: 21
  }
];

const CATEGORY_ITEMS = [
  { id: "همه محصولات", label: "همه", icon: LayoutGrid },
  { id: "محصولات ارتوپدی", label: "ارتوپدی", icon: Bone },
  { id: "محصولات آرایشی بهداشتی", label: "آرایشی بهداشتی", icon: Sparkles },
  { id: "پوست و مو", label: "پوست و مو", icon: Feather },
  { id: "مکمل های غذایی دارویی", label: "مکمل غذایی", icon: Pill },
  { id: "مکمل های ورزشی", label: "مکمل ورزشی", icon: Dumbbell },
  { id: "مادر و کودک", label: "مادر و کودک", icon: Baby },
  { id: "تجهیزات پزشکی", label: "تجهیزات پزشکی", icon: Stethoscope },
];

const BRANDS = ["Lafarrerr", "Prime", "Cerita", "The Ordinary", "Simple", "Kalleh", "Aptamil", "My Baby", "Paksaman", "Cinere", "Seagull", "Callista", "Beurer", "Berry", "Xiaomi"];

const MOCK_REVIEWS: Review[] = [
  { id: '1', userId: 'user1', productId: 1, rating: 5, comment: 'عالی بود، پوستم خیلی شفاف شده.', date: '۱۴۰۲/۱۰/۱۲', userName: 'سارا' },
  { id: '2', userId: 'user2', productId: 1, rating: 4, comment: 'خوبه ولی حجمش کمه.', date: '۱۴۰۲/۱۰/۱۵', userName: 'مریم' },
  { id: '3', userId: 'user3', productId: 4, rating: 5, comment: 'بهترین پروتئینی که تا حالا خوردم.', date: '۱۴۰۲/۱۱/۰۱', userName: 'علی' },
];

// Mock Address for Orders
const MOCK_ADDRESS: Address = {
    id: "addr1",
    title: "منزل",
    city: "تهران",
    province: "تهران",
    fullAddress: "تهران، خیابان پاسداران، خیابان پایدارفرد، پلاک ۱۰۷",
    postalCode: "1234567890",
    lat: 35.6892,
    lng: 51.3890
};

// Create Mock Orders based on Products
const generateMockOrders = (): Order[] => [
    {
        id: "ORD-123456",
        userId: "current-user",
        items: [
            { ...MOCK_PRODUCTS[0], quantity: 1 },
            { ...MOCK_PRODUCTS[5], quantity: 2 }
        ],
        totalPrice: 1200000,
        date: "1402/12/10",
        status: "processing",
        trackingCode: "2456123456",
        shippingMethod: ShippingMethod.JET,
        address: MOCK_ADDRESS
    },
    {
        id: "ORD-987654",
        userId: "current-user",
        items: [
            { ...MOCK_PRODUCTS[2], quantity: 1 }
        ],
        totalPrice: 185000,
        date: "1402/11/20",
        status: "delivered",
        trackingCode: "8877665544",
        shippingMethod: ShippingMethod.POST,
        address: MOCK_ADDRESS
    },
    {
        id: "ORD-456123",
        userId: "current-user",
        items: [
            { ...MOCK_PRODUCTS[8], quantity: 1 },
             { ...MOCK_PRODUCTS[10], quantity: 1 }
        ],
        totalPrice: 1540000,
        date: "1402/12/15",
        status: "pending",
        shippingMethod: ShippingMethod.PICKUP,
        address: MOCK_ADDRESS
    }
];

const App: React.FC = () => {
  const [activeTab, setActiveTab] = useState('home');
  const [products] = useState<Product[]>(MOCK_PRODUCTS);
  
  // Filter States
  const [selectedCategory, setSelectedCategory] = useState("همه محصولات");
  const [searchQuery, setSearchQuery] = useState("");
  const [selectedBrand, setSelectedBrand] = useState("همه برندها");
  const [sortOrder, setSortOrder] = useState<"default" | "asc" | "desc">("default");

  const [isAuthOpen, setIsAuthOpen] = useState(false);
  const [isAddressFormOpen, setIsAddressFormOpen] = useState(false);
  const [editingAddress, setEditingAddress] = useState<Address | null>(null);
  const [selectedProduct, setSelectedProduct] = useState<Product | null>(null);
  const [selectedMagazinePost, setSelectedMagazinePost] = useState<BlogPost | null>(null);

  const [currentUser, setCurrentUser] = useState<User | null>(() => {
    const saved = localStorage.getItem('pharmacy_user');
    return saved ? JSON.parse(saved) : null;
  });
  
  const [reviews, setReviews] = useState<Review[]>(() => {
    const saved = localStorage.getItem('pharmacy_reviews');
    return saved ? JSON.parse(saved) : MOCK_REVIEWS;
  });

  // State for Orders (Mocked + Local Storage logic could be added)
  const [orders, setOrders] = useState<Order[]>(() => {
      // For demo, we initialize with mock orders
      return generateMockOrders();
  });

  const productSectionRef = useRef<HTMLDivElement>(null);
  
  const [cart, setCart] = useState<CartItem[]>(() => {
    const saved = localStorage.getItem('pharmacy_cart');
    return saved ? JSON.parse(saved) : [];
  });

  const [favorites, setFavorites] = useState<number[]>(() => {
    const saved = localStorage.getItem('pharmacy_favorites');
    return saved ? JSON.parse(saved) : [];
  });

  // Ensure scroll to top on tab change or search trigger
  useEffect(() => {
    if (activeTab === 'products' || activeTab === 'home') {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  }, [activeTab]);

  useEffect(() => {
    const isAnyModalOpen = !!selectedProduct || isAuthOpen || isAddressFormOpen;
    document.body.style.overflow = isAnyModalOpen ? 'hidden' : 'unset';
  }, [selectedProduct, isAuthOpen, isAddressFormOpen]);

  useEffect(() => {
    localStorage.setItem('pharmacy_cart', JSON.stringify(cart));
  }, [cart]);

  useEffect(() => {
    localStorage.setItem('pharmacy_favorites', JSON.stringify(favorites));
  }, [favorites]);

  useEffect(() => {
    if (currentUser) {
      localStorage.setItem('pharmacy_user', JSON.stringify(currentUser));
    } else {
      localStorage.removeItem('pharmacy_user');
    }
  }, [currentUser]);

  useEffect(() => {
    localStorage.setItem('pharmacy_reviews', JSON.stringify(reviews));
  }, [reviews]);

  const addToCart = (product: Product) => {
    setCart(prev => {
      const existingItem = prev.find(item => item.id === product.id);
      if (existingItem) {
        return prev.map(item => 
          item.id === product.id ? { ...item, quantity: item.quantity + 1 } : item
        );
      }
      return [...prev, { ...product, quantity: 1 }];
    });
  };

  const updateQuantity = (id: number, delta: number) => {
    setCart(prev => {
      const existing = prev.find(i => i.id === id);
      if (existing && existing.quantity === 1 && delta === -1) {
        return prev.filter(i => i.id !== id);
      }
      return prev.map(item => {
        if (item.id === id) {
          const newQty = Math.max(0, item.quantity + delta);
          return { ...item, quantity: newQty };
        }
        return item;
      }).filter(item => item.quantity > 0);
    });
  };

  const removeFromCart = (id: number) => {
    setCart(prev => prev.filter(item => item.id !== id));
  };

  const toggleFavorite = (id: number) => {
    setFavorites(prev => prev.includes(id) ? prev.filter(f => f !== id) : [...prev, id]);
  };

  const handleCheckoutStart = () => {
    if (!currentUser) setIsAuthOpen(true);
    else setActiveTab('checkout');
  };

  const saveAddress = (addr: Address) => {
    if (currentUser) {
      const exists = currentUser.addresses.find(a => a.id === addr.id);
      const newAddresses = exists 
        ? currentUser.addresses.map(a => a.id === addr.id ? addr : a)
        : [...currentUser.addresses, addr];
      setCurrentUser({ ...currentUser, addresses: newAddresses });
      setIsAddressFormOpen(false);
      setEditingAddress(null);
    }
  };

  // Review Handlers
  const handleAddReview = (review: Review) => {
    setReviews(prev => [review, ...prev]);
  };

  const handleUpdateReview = (updatedReview: Review) => {
    setReviews(prev => prev.map(r => r.id === updatedReview.id ? updatedReview : r));
  };

  const handleDeleteReview = (reviewId: string) => {
    setReviews(prev => prev.filter(r => r.id !== reviewId));
  };

  const handleCancelOrder = (orderId: string) => {
      setOrders(prev => prev.map(order => 
          order.id === orderId 
          ? { ...order, status: 'cancelled' } 
          : order
      ));
  };

  const scrollToProducts = () => {
    setActiveTab('products'); 
  };

  const resetFilters = () => {
      setSearchQuery("");
      setSelectedCategory("همه محصولات");
      setSelectedBrand("همه برندها");
      setSortOrder("default");
  };

  // --- Filtering Logic ---
  const parsePrice = (priceStr: string) => {
    return parseInt(priceStr.replace(/[^0-9]/g, ''), 10) || 0;
  };

  const filteredProducts = products.filter(p => {
    const matchesCategory = selectedCategory === "همه محصولات" || p.category === selectedCategory;
    const matchesSearch = p.name.toLowerCase().includes(searchQuery.toLowerCase()) || 
                         p.description.toLowerCase().includes(searchQuery.toLowerCase());
    const matchesBrand = selectedBrand === "همه برندها" || p.brand === selectedBrand;
    return matchesCategory && matchesSearch && matchesBrand;
  }).sort((a, b) => {
      if (sortOrder === "asc") return parsePrice(a.price) - parsePrice(b.price);
      if (sortOrder === "desc") return parsePrice(b.price) - parsePrice(a.price);
      return 0;
  });

  // --- New Section Logic for Home Page ---
  const medicalProducts = products.filter(p => p.category === "تجهیزات پزشکی");
  const cosmeticsProducts = products.filter(p => p.category === "محصولات آرایشی بهداشتی");
  const skinHairProducts = products.filter(p => p.category === "پوست و مو");
  const supplementProducts = products.filter(p => p.category.includes("مکمل"));
  const momBabyProducts = products.filter(p => p.category === "مادر و کودک");

  const CategoryShowcase = ({ 
    title, 
    products, 
    icon: Icon, 
    accentColor, 
    gradientFrom, 
    gradientTo, 
    filterId
  }: { 
    title: string, 
    products: Product[], 
    icon: any, 
    accentColor: string, 
    gradientFrom: string, 
    gradientTo: string,
    filterId: string
  }) => (
      <section className="mb-20">
          <div className="bg-slate-800/40 backdrop-blur-md rounded-[2.5rem] border border-slate-700/50 overflow-hidden relative group">
              {/* Background Accents */}
              <div className={`absolute -top-20 -right-20 w-64 h-64 bg-gradient-to-br ${gradientFrom} to-transparent rounded-full blur-[80px] opacity-30`}></div>
              <div className={`absolute -bottom-20 -left-20 w-64 h-64 bg-gradient-to-tr ${gradientTo} to-transparent rounded-full blur-[80px] opacity-20`}></div>

              <div className="flex flex-col lg:flex-row">
                  {/* Header / Sidebar Area */}
                  <div className="w-full lg:w-1/4 p-8 lg:p-10 flex flex-col justify-between relative z-10 border-b lg:border-b-0 lg:border-l border-slate-700/50">
                      <div>
                          <div className={`w-16 h-16 rounded-2xl flex items-center justify-center mb-6 shadow-2xl ${accentColor} text-white`}>
                              <Icon className="w-8 h-8" />
                          </div>
                          <h3 className="text-3xl font-display font-bold text-white mb-3 leading-tight">
                              {title}
                          </h3>
                          <p className="text-slate-400 text-sm leading-relaxed mb-6">
                              بهترین محصولات {title} با ضمانت اصالت و کیفیت، انتخاب شده توسط متخصصین.
                          </p>
                      </div>
                      <button 
                          onClick={() => {
                              setSelectedCategory(filterId);
                              setActiveTab('products');
                          }}
                          className={`w-full py-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-all hover:shadow-lg active:scale-95 bg-white/5 hover:bg-white/10 text-white border border-white/10`}
                      >
                          <span>مشاهده همه</span>
                          <ChevronLeft className="w-5 h-5" />
                      </button>
                  </div>

                  {/* Products Horizontal List */}
                  <div className="w-full lg:w-3/4 p-6 lg:p-8">
                      <div className="flex gap-4 md:gap-6 overflow-x-auto pb-4 no-scrollbar snap-x">
                          {products.slice(0, 4).map((product) => (
                              <div key={product.id} className="min-w-[260px] md:min-w-[280px] snap-center">
                                  <ProductCard 
                                      product={product} 
                                      isFavorite={favorites.includes(product.id)}
                                      onToggleFavorite={() => toggleFavorite(product.id)}
                                      onAddToCart={addToCart}
                                      onQuickView={(p) => setSelectedProduct(p)}
                                      cartQuantity={cart.find(i => i.id === product.id)?.quantity || 0}
                                      onUpdateQuantity={updateQuantity}
                                      reviewCount={reviews.filter(r => r.productId === product.id).length}
                                  />
                              </div>
                          ))}
                          <div className="min-w-[100px] flex items-center justify-center snap-center">
                              <button 
                                  onClick={() => {
                                      setSelectedCategory(filterId);
                                      setActiveTab('products');
                                  }}
                                  className="w-14 h-14 rounded-full bg-slate-700/50 hover:bg-pharmacy-500 hover:text-white text-slate-400 flex items-center justify-center transition-all border border-slate-600"
                              >
                                  <ArrowLeft className="w-6 h-6" />
                              </button>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </section>
  );

  return (
    <div className="min-h-screen bg-slate-900 text-white font-sans selection:bg-pharmacy-500 selection:text-white pb-20 md:pb-0">
      <Navbar 
        activeTab={activeTab} 
        setActiveTab={setActiveTab} 
        cartCount={cart.reduce((a, b) => a + b.quantity, 0)}
        currentUser={currentUser}
        onLoginClick={() => setIsAuthOpen(true)}
      />

      <Auth 
        isOpen={isAuthOpen} 
        onClose={() => setIsAuthOpen(false)} 
        onAuthSuccess={setCurrentUser} 
        currentUser={currentUser} 
      />

      {isAddressFormOpen && (
        <AddressForm 
          initialAddress={editingAddress}
          onSave={saveAddress} 
          onCancel={() => {
              setIsAddressFormOpen(false);
              setEditingAddress(null);
          }} 
        />
      )}

      {selectedProduct && (
        <ProductDetailModal 
          product={selectedProduct}
          isOpen={!!selectedProduct}
          onClose={() => setSelectedProduct(null)}
          onAddToCart={addToCart}
          isFavorite={favorites.includes(selectedProduct.id)}
          onToggleFavorite={() => toggleFavorite(selectedProduct.id)}
          cartQuantity={cart.find(i => i.id === selectedProduct.id)?.quantity || 0}
          onUpdateQuantity={updateQuantity}
          reviews={reviews.filter(r => r.productId === selectedProduct.id)}
          onAddReview={handleAddReview}
          currentUser={currentUser}
          onOpenLogin={() => {
            setIsAuthOpen(true);
            setSelectedProduct(null);
          }}
          relatedPost={MOCK_POSTS.find(post => post.relatedProductId === selectedProduct.id)}
          onOpenArticle={(post) => {
              setSelectedProduct(null);
              setSelectedMagazinePost(post);
              setActiveTab('mag');
          }}
        />
      )}

      <main>
        {activeTab === 'home' && (
          <>
            <Hero 
              onExplore={() => {
                   // Scroll to Search Box
                   const element = document.getElementById('ai-search-box');
                   element?.scrollIntoView({ behavior: 'smooth', block: 'center' });
              }} 
              onConsultation={() => setActiveTab('consultation')} 
            />
            
            <div ref={productSectionRef} className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 relative overflow-hidden">
               <div className="absolute top-0 right-0 w-96 h-96 bg-pharmacy-500/5 rounded-full blur-3xl -z-10"></div>
              
              {/* --- MODERN AI SEARCH SECTION --- */}
              <div id="ai-search-box" className="mb-24 relative z-20">
                  <div className="max-w-4xl mx-auto">
                      <div className="text-center mb-8">
                          <h3 className="text-2xl md:text-3xl font-display font-bold text-white mb-2 flex items-center justify-center gap-2">
                             <Sparkles className="text-pharmacy-400 w-6 h-6 animate-pulse" />
                             دنبال چی میگردی؟
                          </h3>
                          <p className="text-slate-400 text-sm md:text-base">نام محصول، برند یا مشکل خود را بنویسید تا هوش مصنوعی بهترین‌ها را پیشنهاد دهد.</p>
                      </div>
                      
                      <div className="relative group">
                          {/* GLOW EFFECT RESTORED HERE */}
                          <div className="absolute inset-0 bg-gradient-to-r from-pharmacy-500 via-purple-500 to-pharmacy-500 rounded-[2rem] opacity-30 group-hover:opacity-50 blur-xl transition-opacity duration-500 -z-10"></div>
                          
                          <div className="relative bg-white/5 backdrop-blur-xl border border-white/10 rounded-[2rem] p-1.5 md:p-2 flex items-center shadow-2xl transition-all group-hover:border-white/20 group-hover:bg-white/10">
                              <div className="p-3 md:p-4 hidden xs:block">
                                  <Search className="w-6 h-6 md:w-8 md:h-8 text-pharmacy-400" />
                              </div>
                              <input 
                                  type="text" 
                                  value={searchQuery}
                                  onChange={(e) => setSearchQuery(e.target.value)}
                                  placeholder="مثلا: کرم ضد آفتاب..."
                                  className="w-full bg-transparent border-none outline-none text-white text-sm md:text-xl placeholder:text-slate-500 h-12 md:h-14 px-2"
                                  onKeyDown={(e) => {
                                      if (e.key === 'Enter') {
                                          setActiveTab('products');
                                      }
                                  }}
                              />
                              <button 
                                  onClick={() => setActiveTab('products')}
                                  className="bg-pharmacy-500 hover:bg-pharmacy-400 text-white px-4 md:px-8 py-3 md:py-4 rounded-[1.5rem] font-bold text-xs md:text-base transition-all shadow-lg active:scale-95 whitespace-nowrap ml-1 flex items-center gap-2"
                              >
                                 <Search className="w-4 h-4 md:hidden" />
                                 <span>جستجو</span>
                              </button>
                          </div>
                      </div>
                  </div>
              </div>

              <div className="text-center mb-16 px-4">
                <span className="text-pharmacy-500 font-bold tracking-wider uppercase text-xs md:text-sm bg-pharmacy-900/30 px-3 py-1 rounded-full border border-pharmacy-500/20">پیشنهاد ویژه</span>
                <h2 className="text-3xl md:text-5xl font-display font-normal text-white mt-4 mb-4">ویترین محصولات</h2>
                <p className="text-slate-400 max-w-2xl mx-auto text-sm md:text-base leading-relaxed">دسته‌بندی‌های منتخب و پرطرفدار داروخانه دکتر شمیم‌نسب</p>
              </div>

              {/* --- NEW CATEGORY SHOWCASES --- */}
              
              {/* 1. Cosmetics */}
              <CategoryShowcase 
                  title="آرایشی و زیبایی" 
                  products={cosmeticsProducts}
                  icon={Sparkles}
                  accentColor="bg-pink-500"
                  gradientFrom="from-pink-500/40"
                  gradientTo="to-purple-500/40"
                  filterId="محصولات آرایشی بهداشتی"
              />

              {/* 2. Skin & Hair */}
              <CategoryShowcase 
                  title="مراقبت پوست و مو" 
                  products={skinHairProducts}
                  icon={Feather}
                  accentColor="bg-pharmacy-500"
                  gradientFrom="from-pharmacy-500/40"
                  gradientTo="to-teal-500/40"
                  filterId="پوست و مو"
              />

              {/* 3. Supplements (Dietary & Sports) */}
              <CategoryShowcase 
                  title="مکمل‌های ورزشی و دارویی" 
                  products={supplementProducts}
                  icon={Zap}
                  accentColor="bg-orange-500"
                  gradientFrom="from-orange-500/40"
                  gradientTo="to-amber-500/40"
                  filterId="مکمل های ورزشی" 
              />

              {/* 4. Mom & Baby */}
              <CategoryShowcase 
                  title="مادر و کودک" 
                  products={momBabyProducts}
                  icon={Baby}
                  accentColor="bg-sky-500"
                  gradientFrom="from-sky-500/40"
                  gradientTo="to-indigo-500/40"
                  filterId="مادر و کودک"
              />
              
              {/* 5. See All Products Button (Updated Minimal Design) */}
              <div className="flex justify-center mt-20 mb-32">
                 <button 
                    onClick={() => {
                        setSelectedCategory("همه محصولات");
                        setActiveTab('products');
                    }}
                    className="group relative px-8 py-4 bg-pharmacy-500 text-white rounded-full font-bold overflow-hidden shadow-lg hover:shadow-pharmacy-500/40 transition-all hover:-translate-y-1 active:scale-95"
                 >
                    {/* Shine Effect */}
                    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
                    
                    <div className="flex items-center gap-3 relative z-10">
                         <span className="text-lg">مشاهده همه محصولات</span>
                         <ArrowDown className="w-5 h-5 animate-bounce" />
                    </div>
                 </button>
              </div>

            </div>
          </>
        )}

        {activeTab === 'products' && (
             <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 md:py-32 min-h-screen">
                <div className="flex flex-col gap-8 mb-16 border-b border-slate-800 pb-12">
                    <div className="text-center md:text-right">
                        <h2 className="text-3xl md:text-6xl font-display font-bold text-white mb-3">محصولات داروخانه</h2>
                        <p className="text-slate-400 text-sm md:text-lg">جستجو و فیلتر از بین ۱۲۰۰ کالای دارویی و آرایشی</p>
                    </div>

                    {/* Search Bar */}
                    <div className="relative group">
                        <input 
                          type="text" 
                          value={searchQuery}
                          onChange={(e) => setSearchQuery(e.target.value)}
                          placeholder="نام محصول، برند یا دسته‌بندی..."
                          className="w-full bg-slate-800/60 border border-slate-700 rounded-2xl md:rounded-[2.5rem] py-5 pr-14 pl-6 text-white outline-none focus:border-pharmacy-500 focus:bg-slate-800 transition-all text-lg shadow-2xl"
                        />
                        <Search className="absolute right-5 top-1/2 -translate-y-1/2 text-slate-500 w-6 h-6 group-focus-within:text-pharmacy-500 transition-colors" />
                        {searchQuery && (
                            <button 
                              onClick={() => setSearchQuery("")}
                              className="absolute left-5 top-1/2 -translate-y-1/2 text-slate-500 hover:text-white"
                            >
                                <CloseIcon className="w-6 h-6" />
                            </button>
                        )}
                    </div>
                    
                    {/* --- Advanced Filters (Brand & Price) --- */}
                    <div className="flex flex-col md:flex-row gap-4 items-center">
                        {/* Brand Filter */}
                        <div className="relative flex-1 w-full">
                            <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400">
                                <Filter className="w-4 h-4" />
                            </div>
                            <select 
                                value={selectedBrand}
                                onChange={(e) => setSelectedBrand(e.target.value)}
                                className="w-full appearance-none bg-slate-800 border border-slate-700 rounded-2xl px-10 py-3 text-white focus:border-pharmacy-500 outline-none cursor-pointer"
                            >
                                <option value="همه برندها">همه برندها</option>
                                {BRANDS.map(brand => (
                                    <option key={brand} value={brand}>{brand}</option>
                                ))}
                            </select>
                        </div>

                        {/* Price Sort */}
                        <div className="relative flex-1 w-full">
                             <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400">
                                {sortOrder === 'asc' ? <SortAsc className="w-4 h-4" /> : <SortDesc className="w-4 h-4" />}
                            </div>
                            <select 
                                value={sortOrder}
                                onChange={(e) => setSortOrder(e.target.value as any)}
                                className="w-full appearance-none bg-slate-800 border border-slate-700 rounded-2xl px-10 py-3 text-white focus:border-pharmacy-500 outline-none cursor-pointer"
                            >
                                <option value="default">مرتب‌سازی پیش‌فرض</option>
                                <option value="asc">ارزان‌ترین به گران‌ترین</option>
                                <option value="desc">گران‌ترین به ارزان‌ترین</option>
                            </select>
                        </div>

                        {/* Reset Filters Button - Shows only when filters are active */}
                        {(searchQuery !== "" || selectedCategory !== "همه محصولات" || selectedBrand !== "همه برندها" || sortOrder !== "default") && (
                            <button 
                                onClick={resetFilters}
                                className="flex items-center gap-2 bg-rose-500/10 hover:bg-rose-500 text-rose-500 hover:text-white px-6 py-3 rounded-2xl transition-all border border-rose-500/20 w-full md:w-auto justify-center"
                                title="حذف تمام فیلترها"
                            >
                                <RotateCcw className="w-4 h-4" />
                                <span className="text-sm font-bold">حذف فیلترها</span>
                            </button>
                        )}
                    </div>

                    {/* Categories Filter - Responsive Design */}
                    <div>
                        <div className="flex items-center gap-2 mb-4 text-slate-400 text-sm font-bold">
                           <SlidersHorizontal className="w-4 h-4" />
                           دسته‌بندی‌ها
                        </div>
                        
                        {/* Mobile Friendly Horizontal Scrollable List with Large Touch Targets */}
                        <div className="flex gap-4 overflow-x-auto pb-6 -mx-4 px-4 md:mx-0 md:px-0 no-scrollbar snap-x snap-mandatory">
                            {CATEGORY_ITEMS.map((item) => {
                                const Icon = item.icon;
                                const isSelected = selectedCategory === item.id;
                                return (
                                    <button 
                                        key={item.id} 
                                        onClick={() => setSelectedCategory(item.id)} 
                                        className={`flex-shrink-0 snap-start flex flex-col items-center gap-3 min-w-[85px] md:min-w-0 md:w-auto p-2 rounded-2xl transition-all group ${
                                            isSelected ? 'scale-105' : 'opacity-70 hover:opacity-100'
                                        }`}
                                    >
                                        <div className={`w-14 h-14 md:w-20 md:h-20 rounded-2xl md:rounded-[1.5rem] flex items-center justify-center transition-all shadow-lg ${
                                            isSelected 
                                            ? 'bg-pharmacy-500 text-white shadow-pharmacy-500/30' 
                                            : 'bg-slate-800 border border-slate-700 text-slate-400 group-hover:border-slate-500'
                                        }`}>
                                            <Icon className="w-7 h-7 md:w-8 md:h-8" />
                                        </div>
                                        <span className={`text-xs md:text-sm font-bold text-center ${
                                            isSelected ? 'text-pharmacy-400' : 'text-slate-400'
                                        }`}>
                                            {item.label}
                                        </span>
                                    </button>
                                );
                            })}
                        </div>
                    </div>
                </div>

                {filteredProducts.length > 0 ? (
                    <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-8">
                        {filteredProducts.map((product) => (
                            <ProductCard 
                                key={product.id} 
                                product={product} 
                                isFavorite={favorites.includes(product.id)}
                                onToggleFavorite={() => toggleFavorite(product.id)}
                                onAddToCart={addToCart}
                                onQuickView={(p) => setSelectedProduct(p)}
                                cartQuantity={cart.find(i => i.id === product.id)?.quantity || 0}
                                onUpdateQuantity={updateQuantity}
                                reviewCount={reviews.filter(r => r.productId === product.id).length}
                            />
                        ))}
                    </div>
                ) : (
                    <div className="py-24 text-center bg-slate-800/20 rounded-[3rem] border-2 border-slate-800 border-dashed">
                        <Search className="w-20 h-20 text-slate-700 mx-auto mb-6" />
                        <h3 className="text-2xl md:text-3xl font-bold text-white mb-3">محصولی پیدا نشد!</h3>
                        <p className="text-slate-500 text-sm md:text-lg">لطفاً عبارت دیگری را جستجو کنید یا فیلترها را تغییر دهید.</p>
                        <button 
                            onClick={resetFilters}
                            className="mt-10 bg-slate-800 px-8 py-3 rounded-2xl text-pharmacy-500 font-bold hover:text-white transition-colors"
                        >
                            پاک کردن همه فیلترها
                        </button>
                    </div>
                )}
             </div>
        )}

        {activeTab === 'mag' && (
          <Magazine 
            posts={MOCK_POSTS}
            products={products}
            onOpenProduct={(p) => setSelectedProduct(p)}
            onAddToCart={addToCart}
            favorites={favorites}
            onToggleFavorite={toggleFavorite}
            cart={cart}
            onUpdateQuantity={updateQuantity}
            initialPost={selectedMagazinePost}
            onClearInitialPost={() => setSelectedMagazinePost(null)}
          />
        )}

        {activeTab === 'cart' && (
            <Cart 
                items={cart} 
                onUpdateQuantity={updateQuantity} 
                onRemove={removeFromCart} 
                onCheckout={handleCheckoutStart} 
                onContinueShopping={() => setActiveTab('products')}
            />
        )}

        {activeTab === 'consultation' && (
            <Consultation />
        )}

        {activeTab === 'profile' && currentUser && (
            <Profile 
              user={currentUser} 
              onLogout={() => { setCurrentUser(null); setActiveTab('home'); }} 
              onAddAddress={() => setIsAddressFormOpen(true)}
              onEditAddress={(addr) => {
                  setEditingAddress(addr);
                  setIsAddressFormOpen(true);
              }}
              onDeleteAddress={(id) => setCurrentUser({ ...currentUser, addresses: currentUser.addresses.filter(a => a.id !== id) })}
              onUpdateProfile={(f, l, n, p) => setCurrentUser({ ...currentUser, firstName: f, lastName: l, nationalId: n, phone: p })}
              userReviews={reviews.filter(r => r.userId === currentUser.id)}
              products={products}
              onUpdateReview={handleUpdateReview}
              onDeleteReview={handleDeleteReview}
              orders={orders}
              onCancelOrder={handleCancelOrder}
              onOpenProduct={(p) => setSelectedProduct(p)}
            />
        )}

        {activeTab === 'checkout' && currentUser && (
          <CheckoutWizard 
            items={cart} 
            user={currentUser} 
            onComplete={(orderData: any) => {
                const newOrder: Order = {
                    id: `ORD-${Date.now().toString().slice(-6)}`,
                    userId: currentUser.id,
                    items: [...cart],
                    totalPrice: orderData.total,
                    date: new Date().toLocaleDateString('fa-IR'),
                    status: 'pending',
                    shippingMethod: orderData.shipping,
                    address: currentUser.addresses.find(a => a.id === orderData.selectedAddress)!,
                    trackingCode: undefined
                };
                
                setOrders(prev => [newOrder, ...prev]);
                setCart([]);
                setActiveTab('profile'); // Redirect to profile to see the new order
                alert('سفارش شما با موفقیت ثبت شد!');
            }}
            onCancel={() => setActiveTab('cart')}
            onAddAddress={() => setIsAddressFormOpen(true)}
          />
        )}
      </main>

      {activeTab !== 'consultation' && <Footer />}
      
      {/* Mobile Bottom Navigation Bar */}
      <MobileNav 
        activeTab={activeTab} 
        setActiveTab={setActiveTab} 
        cartCount={cart.reduce((a, b) => a + b.quantity, 0)}
      />
    </div>
  );
};

export default App;
